<!DOCTYPE html>
<html>
<head>
  <title>Inventory API Test - Full</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, textarea { width: 300px; margin: 5px 0; display: block; }
    button { margin: 5px 0; }
    pre { background: #f4f4f4; padding: 10px; border-radius: 5px; white-space: pre-wrap; }
    hr { margin: 20px 0; }
  </style>
</head>
<body>
  <h1>Inventory API Test - Full</h1>

  <label>JWT Access Token:</label>
  <input type="text" id="token" placeholder="Paste your access token here">

  <h2>Actions</h2>
  <button onclick="loadItems()">GET All Items</button>
  <button onclick="addAllItems()">Add All Example Items</button>

  <hr>
  <h2>Create New Item</h2>
  <input id="name" placeholder="Name">
  <input id="description" placeholder="Description">
  <input id="quantity" type="number" placeholder="Quantity">
  <input id="price" type="number" step="0.01" placeholder="Price">
  <input id="category" placeholder="Category">
  <button onclick="createItem()">POST /api/items/</button>

  <hr>
  <h2>Update Item</h2>
  <input id="update_id" placeholder="Item ID">
  <input id="update_name" placeholder="New Name">
  <input id="update_quantity" type="number" placeholder="New Quantity">
  <button onclick="updateItem()">PUT /api/items/&lt;id&gt;/</button>

  <hr>
  <h2>Delete Item</h2>
  <input id="delete_id" placeholder="Item ID">
  <button onclick="deleteItem()">DELETE /api/items/&lt;id&gt;/</button>

  <hr>
  <h2>Output</h2>
  <pre id="output"></pre>

  <script>
    const baseUrl = "http://127.0.0.1:8000/api/items/";

    function getHeaders() {
      let token = document.getElementById("token").value.trim();
      if (!token.startsWith("Bearer ")) {
        token = "Bearer " + token;
      }
      return {
        "Authorization": token,
        "Content-Type": "application/json"
      };
    }

    async function loadItems() {
      try {
        const res = await fetch(baseUrl, { headers: getHeaders() });
        const data = await res.json();
        document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("output").textContent = err;
      }
    }

    async function createItem() {
      const body = {
        name: document.getElementById("name").value,
        description: document.getElementById("description").value,
        quantity: parseInt(document.getElementById("quantity").value),
        price: parseFloat(document.getElementById("price").value),
        category: document.getElementById("category").value
      };
      const res = await fetch(baseUrl, {
        method: "POST",
        headers: getHeaders(),
        body: JSON.stringify(body)
      });
      const data = await res.json();
      document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      loadItems();
    }

    async function updateItem() {
      const id = document.getElementById("update_id").value;
      const body = {
        name: document.getElementById("update_name").value,
        quantity: parseInt(document.getElementById("update_quantity").value)
      };
      const res = await fetch(baseUrl + id + "/", {
        method: "PUT",
        headers: getHeaders(),
        body: JSON.stringify(body)
      });
      const data = await res.json();
      document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      loadItems();
    }

    async function deleteItem() {
      const id = document.getElementById("delete_id").value;
      const res = await fetch(baseUrl + id + "/", {
        method: "DELETE",
        headers: getHeaders()
      });
      document.getElementById("output").textContent = res.status + " " + res.statusText;
      loadItems();
    }

    async function addAllItems() {
      const items = [
        { "name": "Laptop", "description": "High-end gaming laptop", "quantity": 5, "price": 2500.00, "category": "Electronics" },
        { "name": "Office Chair", "description": "Ergonomic swivel chair", "quantity": 10, "price": 150.00, "category": "Furniture" },
        { "name": "Notebook", "description": "200-page ruled notebook", "quantity": 50, "price": 3.50, "category": "Stationery" },
        { "name": "Desk Lamp", "description": "LED desk lamp with adjustable brightness", "quantity": 15, "price": 45.00, "category": "Electronics" },
        { "name": "Water Bottle", "description": "1-liter stainless steel bottle", "quantity": 30, "price": 12.00, "category": "Kitchenware" }
      ];

      for (const item of items) {
        const res = await fetch(baseUrl, {
          method: "POST",
          headers: getHeaders(),
          body: JSON.stringify(item)
        });
        const data = await res.json();
        document.getElementById("output").textContent += JSON.stringify(data, null, 2) + "\n";
      }

      loadItems();
    }
  </script>
</body>
</html>
